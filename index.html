<html>
	<head>
		<script src="js/mail-generator.js"></script>
		<link href="css/style.css" rel="stylesheet" media="screen">
    <script>
      window.onload = function(){
        // ALL OF YOUR JAVASCRIPT CODE SHOULD GO HERE. 
        // We have to use window.onload so your JavaScript doesn't execute until the page has loaded and all HTML has been downloaded to your browser


        var allGeemails = window.geemails;
		var inboxCount;

        // Create geemails
		var getGeemails = function(inboxCount){

			var msgDate;
			var msgSubject;
			var msgSender;
			var msgBody;

			

				// Email skellie
				function email(date, sender, subject, body){
					this.date = date;
					this.seder= sender;
					this.subject= subject;
					this.body= body;
				}

				// Check if first 10 are loaded, if so create new ones
				if(inboxCount>9){
				
				var newGeemail = getNewMessage();
				msgDate = newGeemail.date;
				msgSubject = newGeemail.subject;
				msgSender = newGeemail.sender;
				msgBody = newGeemail.body;

			}
			else{
				msgDate = allGeemails[inboxCount].date;
				msgSubject = allGeemails[inboxCount].subject;
				msgSender = allGeemails[inboxCount].sender;
				msgBody = allGeemails[inboxCount].body;
			}


			// Create new email, with date, sender, subject, and body attached
			var inbox = document.getElementById("inbox");
			var newEmail = document.createElement("div");
			newEmail.className = "not-clicked"; // Entire email div w/ date, sender, sub, body as 'p's
				newEmail.style.borderStyle = "ridge";
				newEmail.style.backgroundColor = "white";
				newEmail.style.opacity = ".65";
				newEmail.style.padding = "5px";


			email.date = document.createElement("p");
				email.date.className = "email-date";
				email.date.innerHTML = msgDate.toString().substring(4, 21);
				email.date.style.fontWeight = "bolder";
			email.sender = document.createElement("p");
				email.sender.className = "email-sender";
				email.sender.innerHTML = msgSender;
				email.sender.style.fontWeight = "bolder";
			email.subject = document.createElement("p");
				email.subject.className = "email-subject";
				email.subject.innerHTML = msgSubject;
				email.subject.style.fontWeight = "bolder";
			email.body = document.createElement("p");
				email.body.className = "email-body";
				email.body.innerHTML = msgBody;
				email.body.style.fontStyle = "italic";

			// Section turns white when clicked
			 inbox.onclick = function(event){
			 	if(event.target.className === "not-clicked" && event.target.localName === "div"){
			 		// Mark emails read
			 		event.target.childNodes[0].style.fontWeight = "normal";
			 		event.target.childNodes[1].style.fontWeight = "normal";
			 		event.target.childNodes[2].style.fontWeight = "normal";

			 		event.target.childNodes[3].style.fontStyle = "normal";
			 		event.target.childNodes[3].style.color = "black";

			 		event.target.childNodes[3].style.overflow = "visible"; // Show full email body content
			 	

			 		event.target.className = "clicked";
			 	}
			 	else if (event.target.localName === "div"){
			 		event.target.childNodes[3].style.overflow = "hidden";
			 		event.target.className = "not-clicked";
			 	}
			 	else{
			 		return;
			 	}
			
			}	


			// Add info to new email
			for (var key in email){
				newEmail.appendChild(email[key]);
			};


			// Add emails to inbox
			inbox.appendChild(newEmail);



			// Show inbox count
			var content = document.getElementById("inbox-content");
			content.innerHTML = "Inbox (" + inboxCount + ")";

		 }; // End function for creating geemails


		 // Create first 10 geemails
		 for(var inboxCount=0; inboxCount<allGeemails.length; inboxCount++){
		 getGeemails(inboxCount);
		}

		// Create new geemails every ~seconds
		setInterval(function(){ getGeemails(inboxCount++) }, 15000);


		
};
      
    </script>
	</head>
	<body>

		<div class="container" id="main">

		<!-- <img id="background" src="http://i.imgur.com/kLEnZ9o.jpg" /> -->

		<title>GeeMail</title>

			<!-- Geemail Header -->
			<div class="GeeMail">
				
				<h1><a href="file:///C:/Users/Malia/Documents/GitHub/gee-mail/index.html" title="Refresh the page!"><img id="img" src="http://findicons.com/icon/download/130152/mail_alt/128/png?id=369060" />GeeMail</a></h1>
		


			</div>


			<div id="inbox-content"></div>

			<!-- list of emails -->
			<div class="geemail-content">
			
					<div id="inbox">
						
					</div>


				</div>	
			</div>
	</body>
</html>