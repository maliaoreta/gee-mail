<html>
	<head>
		<script src="js/mail-generator.js"></script>
		<link href="css/style.css" rel="stylesheet" media="screen">
    <script>
      window.onload = function(){
        // ALL OF YOUR JAVASCRIPT CODE SHOULD GO HERE. 
        // We have to use window.onload so your JavaScript doesn't execute until the page has loaded and all HTML has been downloaded to your browser


        var allGeemails = window.geemails;
		

        // Create geemails
		var getGeemails = function(index){

			var msgDate;
			var msgSubject;
			var msgSender;
			var msgBody;

			

				// Email skellie
				function email(date, sender, subject, body){
					this.date = date;
					this.seder= sender;
					this.subject= subject;
					this.body= body;
				}

				// Check if first 10 are loaded, if so create new ones
				if(index>9){
				var newGeemail = getNewMessage();
				msgDate = newGeemail.date;
				msgSubject = newGeemail.subject;
				msgSender = newGeemail.sender;
				msgBody = newGeemail.body;

			}
			else{
				msgDate = allGeemails[index].date;
				msgSubject = allGeemails[index].subject;
				msgSender = allGeemails[index].sender;
				msgBody = allGeemails[index].body;
			}


			// Create new email, with date, sender, subject, and body attached
			var inbox = document.getElementById("inbox");
			var newEmail = document.createElement("div");
			newEmail.className = "not-clicked";
			newEmail.style.maxHeight = "150px";
			email.date = document.createElement("p");
			email.date.className = "email-date";
			email.date.innerHTML = msgDate.toString().substring(4, 21);
			email.sender = document.createElement("p");
			email.sender.className = "email-sender";
			email.sender.innerHTML = msgSender;
			email.subject = document.createElement("p");
			email.subject.className = "email-subject";
			email.subject.innerHTML = msgSubject;
			email.body = document.createElement("p");
			email.body.className = "email-body";
			email.body.innerHTML = msgBody;
			email.body.style.color = "gray";
			

			// Section turns white when clicked
			 inbox.onclick = function(event){
			 	if(event.target.className === "not-clicked" && event.target.localName === "div"){
			 		event.target.childNodes[3].style.color = "white"; // [3] is email-body
			 		event.target.className = "clicked";
			 	}
			 	else if (event.target.localName === "div"){
			 		event.target.childNodes[3].style.color = "gray";
			 		event.target.className = "not-clicked";
			 	}
			 	else{
			 		return;
			 	}
			}	


			// Add info to new email
			for (var key in email){
				newEmail.appendChild(email[key]);
			};


			// Add emails to inbox
			inbox.appendChild(newEmail);
	
		 }; // End function for creating geemails


		 // Create first 10 geemails
		 for(var i=0; i<allGeemails.length; i++){
		 getGeemails(i);
		}

		// Create new geemails every ~seconds
		setInterval(function(){ getGeemails(10) }, 3000);

		
};
      
    </script>
	</head>
	<body>
		<div class="container" id="main">

			<!-- Geemail Header -->
			<div class="GeeMail">
				<h1>GeeMail</h1>



			</div>

			<!-- list of emails -->
			<div class="geemail-content">
			
				<div id="inbox-counter"></div>
				

					<div id="inbox">
						
					</div>


				</div>	
			</div>
	</body>
</html>